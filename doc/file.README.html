<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.26
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'>
<p><a href="https://github.com/geospin-takelage/takelage-cli/blob/main/LICENSE"><img src="https://img.shields.io/github/license/geospin-takelage/takelage-cli?color=blueviolet"></a> <a href="https://rubygems.org/gems/takelage"><img src="https://img.shields.io/gem/v/takelage?label=rubygems.org&color=blue"></a> <a href="https://github.com/geospin-takelage/takelage-cli/actions/workflows/build_test_deploy_project_on_push.yml"><img src="https://img.shields.io/github/workflow/status/geospin-takelage/takelage-cli/Build,%20test%20and%20deploy%20project?label=deploy%20project"></a> <a href="https://github.com/geospin-takelage/takelage-cli/actions/workflows/test_project_nightly.yml"><img src="https://img.shields.io/github/workflow/status/geospin-takelage/takelage-cli/Test%20project?label=test%20project"></a></p>

<h1 id="label-takelage-cli">takelage-cli</h1>

<p><em>takelage-cli</em> is a command line interface to facilitate the takelage devops workflow. The takelage devops workflow helps devops engineers build, test and deploy os images.</p>

<p>The <em>takelage-cli</em> executable <em>tau</em> is a <a href="https://www.ruby-lang.org/">ruby</a> command line script using the <a href="http://whatisthor.com/">thor</a> toolkit.</p>

<h2 id="label-Framework+Versions">Framework Versions</h2>

<p>| App | Artifact | | — | ——– | | <em><a href="https://github.com/geospin-takelage/takelage-doc">takelage-doc</a></em> | <a href="https://github.com/geospin-takelage/takelage-doc/blob/main/LICENSE"><img src="https://img.shields.io/github/license/geospin-takelage/takelage-doc?color=blueviolet"></a> | | <em><a href="https://github.com/geospin-takelage/takelage-dev">takelage-dev</a></em> | <a href="https://hub.docker.com/r/takelage/takelage"><img src="https://img.shields.io/docker/v/takelage/takelage/latest?label=hub.docker.com&sort=semver&color=blue"></a> | | <em><a href="https://github.com/geospin-takelage/takelage-cli">takelage-cli</a></em> | <a href="https://rubygems.org/gems/takelage"><img src="https://img.shields.io/gem/v/takelage?label=rubygems.org&color=blue"></a> | | <em><a href="https://github.com/geospin-takelage/takelage-var">takelage-var</a></em> | <a href="https://pypi.org/project/takeltest/"><img src="https://img.shields.io/pypi/v/takeltest?label=pypi.org&color=blue"></a> | | <em><a href="https://github.com/geospin-takelage/takelage-bit">takelage-bit</a></em> | <a href="https://hub.docker.com/r/takelage/bitboard"><img src="https://img.shields.io/docker/v/takelage/bitboard/latest?label=hub.docker.com&sort=semver&color=blue"></a> | | <em><a href="https://github.com/geospin-takelage/takelage-img-takelslim">takelage-img-takelslim</a></em> | <a href="https://hub.docker.com/r/takelage/takelslim"><img src="https://img.shields.io/docker/v/takelage/takelslim/latest?label=hub.docker.com&color=blue"></a> | | <em><a href="https://github.com/geospin-takelage/takelage-img-takelbase">takelage-img-takelbase</a></em> | <a href="https://hub.docker.com/r/takelage/takelbase"><img src="https://img.shields.io/docker/v/takelage/takelbase/latest?label=hub.docker.com&color=blue"></a> | | <em><a href="https://github.com/geospin-takelage/takelage-img-multipostgres">takelage-img-multipostgres</a></em> | <a href="https://hub.docker.com/r/takelage/multipostgres"><img src="https://img.shields.io/docker/v/takelage/multipostgres/latest?label=hub.docker.com&color=blue"></a> |</p>

<h2 id="label-Framework+Status">Framework Status</h2>

<p>| App | Deploy project | Test project | Test roles | | — | ————– | ———— | ———- | | <em><a href="https://github.com/geospin-takelage/takelage-dev">takelage-dev</a></em> | <a href="https://github.com/geospin-takelage/takelage-dev/actions/workflows/build_test_deploy_project_on_push.yml"><img src="https://img.shields.io/github/workflow/status/geospin-takelage/takelage-dev/Build,%20test%20and%20deploy%20project?label=deploy%20project"></a> | <a href="https://github.com/geospin-takelage/takelage-dev/actions/workflows/build_test_project_nightly.yml"><img src="https://img.shields.io/github/workflow/status/geospin-takelage/takelage-dev/Build%20and%20test%20project?label=test%20project"></a> | <a href="https://github.com/geospin-takelage/takelage-dev/actions/workflows/build_test_roles_nightly.yml"><img src="https://img.shields.io/github/workflow/status/geospin-takelage/takelage-dev/Test%20roles?label=test%20roles"></a> | | <em><a href="https://github.com/geospin-takelage/takelage-cli">takelage-cli</a></em> | <a href="https://github.com/geospin-takelage/takelage-cli/actions/workflows/build_test_deploy_project_on_push.yml"><img src="https://img.shields.io/github/workflow/status/geospin-takelage/takelage-cli/Build,%20test%20and%20deploy%20project?label=deploy%20project"></a> | <a href="https://github.com/geospin-takelage/takelage-cli/actions/workflows/test_project_nightly.yml"><img src="https://img.shields.io/github/workflow/status/geospin-takelage/takelage-cli/Test%20project?label=test%20project"></a> | | <em><a href="https://github.com/geospin-takelage/takelage-var">takelage-var</a></em> | <a href="https://github.com/geospin-takelage/takelage-var/actions/workflows/build_test_deploy_project_on_push.yml"><img src="https://img.shields.io/github/workflow/status/geospin-takelage/takelage-var/Build,%20test%20and%20deploy%20project?label=deploy%20project"></a> | <a href="https://github.com/geospin-takelage/takelage-var/actions/workflows/build_test_project_nightly.yml"><img src="https://img.shields.io/github/workflow/status/geospin-takelage/takelage-var/Build%20and%20test%20project?label=test%20project"></a> | | <em><a href="https://github.com/geospin-takelage/takelage-bit">takelage-bit</a></em> | <a href="https://github.com/geospin-takelage/takelage-bit/actions/workflows/build_test_deploy_project_on_push.yml"><img src="https://img.shields.io/github/workflow/status/geospin-takelage/takelage-bit/Build,%20test%20and%20deploy%20project?label=deploy%20project"></a> | <a href="https://github.com/geospin-takelage/takelage-bit/actions/workflows/build_test_project_nightly.yml"><img src="https://img.shields.io/github/workflow/status/geospin-takelage/takelage-bit/Build%20and%20test%20project?label=test%20project"></a> | <a href="https://github.com/geospin-takelage/takelage-bit/actions/workflows/build_test_roles_nightly.yml"><img src="https://img.shields.io/github/workflow/status/geospin-takelage/takelage-bit/Test%20roles?label=test%20roles"></a> | | <em><a href="https://github.com/geospin-takelage/takelage-img-takelslim">takelage-img-takelslim</a></em> | <a href="https://github.com/geospin-takelage/takelage-img-takelslim/actions/workflows/build_deploy_takelslim_nightly.yml"><img src="https://img.shields.io/github/workflow/status/geospin-takelage/takelage-img-takelslim/Build%20and%20deploy%20takelslim?label=deploy%20project"></a> | | <em><a href="https://github.com/geospin-takelage/takelage-img-takelbase">takelage-img-takelbase</a></em> | <a href="https://github.com/geospin-takelage/takelage-img-takelbase/actions/workflows/build_deploy_takelbase_nightly.yml"><img src="https://img.shields.io/github/workflow/status/geospin-takelage/takelage-img-takelbase/Build%20and%20deploy%20takelbase?label=deploy%20project"></a> | | <em><a href="https://github.com/geospin-takelage/takelage-img-multipostgres">takelage-img-multipostgres</a></em> | <a href="https://github.com/geospin-takelage/takelage-img-multipostgres/actions/workflows/build_deploy_multipostgres_nightly.yml"><img src="https://img.shields.io/github/workflow/status/geospin-takelage/takelage-img-multipostgres/Build%20and%20deploy%20multipostgres?label=deploy%20project"></a> |</p>

<h2 id="label-Installation">Installation</h2>

<p><em>tau</em> is part of <em>takelage-dev</em>&#39;s docker image but you typically want to install it on the host system as well. Install the takelage gem and its dependencies through the <a href="https://github.com/rubygems/rubygems">gem</a> command line tool:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_takelage'>takelage</span>
</code></pre>

<h2 id="label-Commands">Commands</h2>

<p><em>takelage-cli</em> uses <a href="https://github.com/cucumber/cucumber">cucumber</a> to system test its features. You are encouraged to read the cucumber feature files for the <em>tau</em> commands to get an idea of how the commands work. You can list the <em>tau</em> commands by running <em>tau <a href="features/cucumber/features/self/self.list.feature">self list</a></em> or <em>tau list</em>:</p>

<p>Command | Description ——- | ———– tau <a href="features/cucumber/features/bit/bit.check.workspace.feature">bit check workspace</a> | Check if a bit workspace exists tau <a href="features/cucumber/features/bit/bit.clipboard.copy.feature">bit clipboard copy</a> [DIR] [SCOPE] | Copy new [DIR] to [SCOPE] tau <a href="features/cucumber/features/bit/bit.clipboard.paste.feature">bit clipboard paste</a> [COMPONENT] [DIR] | Paste bit [COMPONENT] into [DIR] tau <a href="features/cucumber/features/bit/bit.clipboard.pull.feature">bit clipboard pull</a> | Pull all updates for bit components from bit remote scopes tau <a href="features/cucumber/features/bit/bit.clipboard.push.feature">bit clipboard push</a> | Push all updates of bit components to bit remote scopes tau <a href="features/cucumber/features/bit/bit.require.export.feature">bit require export</a> | Show requirements file of bit components tau <a href="features/cucumber/features/bit/bit.require.import.feature">bit require import</a> | Import bit components from requirements file tau <a href="features/cucumber/features/bit/bit.scope.add.feature">bit scope add</a> [SCOPE] | Add a bit [SCOPE] tau <a href="features/cucumber/features/bit/bit.scope.inbit.feature">bit scope inbit</a> | Log in to bit remote server tau <a href="features/cucumber/features/bit/bit.scope.list.feature">bit scope list</a> | List bit remote scopes tau <a href="features/cucumber/features/bit/bit.scope.new.feature">bit scope new</a> [SCOPE] | Init a new bit [SCOPE] tau <a href="features/cucumber/features/completion/completion.bash.feature">completion bash</a> | Print bash completion code tau <a href="features/cucumber/features/docker/docker.check.daemon.feature">docker check daemon</a> | Check if docker daemon is running tau <a href="features/cucumber/features/docker/docker.check.socat.feature">docker check socat</a> | Check if socat command is available tau <a href="features/cucumber/features/docker/docker.container.check.existing.feature">docker container check existing</a> [CONTAINER] | Check if docker [CONTAINER] is existing tau <a href="features/cucumber/features/docker/docker.container.check.network.feature">docker container check network</a> [NETWORK] | Check if docker [NETWORK] is existing tau <a href="features/cucumber/features/docker/docker.container.check.orphaned.feature">docker container check orphaned</a> [CONTAINER] | Check if docker [CONTAINER] is orphaned tau <a href="features/cucumber/features/docker/docker.container.clean.feature">docker container clean</a> | Remove all docker containers tau <a href="features/cucumber/features/docker/docker.container.command.feature">docker container command</a> [CMD] | Run [CMD] in a docker container tau <a href="features/cucumber/features/docker/docker.container.daemon.feature">docker container daemon</a> | Run docker container in daemon mode tau <a href="features/cucumber/features/docker/docker.container.login.feature">docker container login</a> | Log in to latest local docker container tau <a href="features/cucumber/features/docker/docker.container.prune.feature">docker container prune</a> | Remove orphaned docker containers tau <a href="features/cucumber/features/docker/docker.image.tag.check.feature">docker image tag check</a> [TAG] | Check if local docker image [TAG] exists tau <a href="features/cucumber/features/docker/docker.image.tag.latest.feature">docker image tag latest</a> | Print latest local docker image tag tau <a href="features/cucumber/features/docker/docker.image.tag.list.feature">docker image tag list</a> | Print local docker image tags tau <a href="features/cucumber/features/docker/docker.image.update.feature">docker image update</a> | Get latest remote docker container tau <a href="features/cucumber/features/docker/docker.socket.host.feature">docker socket host</a> | Print docker socket host ip address tau <a href="features/cucumber/features/docker/docker.socket.scheme.feature">docker socket scheme</a> | Print docker socket scheme tau <a href="features/cucumber/features/docker/docker.socket.start.feature">docker socket start</a> | Start sockets for docker container tau <a href="features/cucumber/features/docker/docker.socket.stop.feature">docker socket stop</a> | Stop sockets for docker container tau <a href="features/cucumber/features/git/git.check.clean.feature">git check clean</a> | Check if the git workspace is clean tau <a href="features/cucumber/features/git/git.check.main.feature">git check main</a> | Check if we are on the git main branch tau <a href="features/cucumber/features/git/git.check.workspace.feature">git check workspace</a> | Check if a git workspace exists tau <a href="features/cucumber/features/info/info.project.active.feature">info project active</a> | Print active project info tau <a href="features/cucumber/features/info/info.project.dir.feature">info project dir</a> | Print project root directory tau <a href="features/cucumber/features/info/info.project.main.feature">info project main</a> | Print main project info tau <a href="features/cucumber/features/info/info.project.private.feature">info project private</a> | Print private project info tau <a href="features/cucumber/features/info/info.status.bar.feature">info status bar</a> | Print status bar tau <a href="features/cucumber/features/info/info.status.git.feature">info status git</a> | Check git status tau <a href="features/cucumber/features/info/info.status.gopass.feature">info status gopass</a> | Check gopass status tau <a href="features/cucumber/features/info/info.status.gpg.feature">info status gpg</a> | Check gpg status tau <a href="features/cucumber/features/info/info.status.mutagen.feature">info status mutagen</a> | Check mutagen status tau <a href="features/cucumber/features/info/info.status.ssh.feature">info status ssh</a> | Check ssh status tau <a href="features/cucumber/features/mutagen/mutagen.check.daemon.feature">mutagen check daemon</a>) | Check if mutagen host conenction is available tau <a href="features/cucumber/features/mutagen/mutagen.socket.check.feature">mutagen socket check</a> [SOCKET] | Check if mutagen [SOCKET] exists tau <a href="features/cucumber/features/mutagen/mutagen.socket.create.feature">mutagen socket create</a> [IN] [OUT] | Create a mutagen socket from [IN] to [OUT] of the container tau <a href="features/cucumber/features/mutagen/mutagen.socket.list.feature">mutagen socket list</a> | List mutagen sockets tau <a href="features/cucumber/features/mutagen/mutagen.socket.terminate.feature">mutagen socket terminate</a> | Terminate a mutagen socket tau <a href="features/cucumber/features/self/self.config.active.feature">self config active</a> | Print active takelage configuration tau <a href="features/cucumber/features/self/self.config.default.feature">self config default</a> | Print takelage default configuration tau <a href="features/cucumber/features/self/self.config.home.feature">self config home</a> | Print takelage home config file configuration tau <a href="features/cucumber/features/self/self.config.project.feature">self config project</a> | Print takelage project config file configuration tau <a href="features/cucumber/features/self/self.list.feature">self list</a> | List all commands tau <a href="features/cucumber/features/self/self.version.feature">self version</a> | Print tau semantic version number tau clean | Alias for tau <a href="features/cucumber/features/docker/docker.container.clean.feature">docker container clean</a> tau config | Alias for tau <a href="features/cucumber/features/self/self.config.active.feature">self config active</a> tau copy [DIR] [SCOPE] | Alias for tau <a href="features/cucumber/features/bit/bit.clipboard.copy.feature">bit clipboard copy</a> tau list | Alias for tau <a href="features/cucumber/features/self/self.list.feature">self list</a> tau login | Alias for tau <a href="features/cucumber/features/docker/docker.container.login.feature">docker container login</a> tau paste [COMPONENT] [DIR] | Alias for tau <a href="features/cucumber/features/bit/bit.clipboard.paste.feature">bit clipboard paste</a> tau project | Alias for tau <a href="features/cucumber/features/info/info.project.active.feature">info project active</a> tau prune | Alias for tau <a href="features/cucumber/features/docker/docker.container.prune.feature">docker container prune</a> tau pull | Alias for tau <a href="features/cucumber/features/bit/bit.clipboard.pull.feature">bit clipboard pull</a> tau push | Alias for tau <a href="features/cucumber/features/bit/bit.clipboard.push.feature">bit clipboard push</a> tau status | Alias for tau <a href="features/cucumber/features/info/info.status.bar.feature">docker info status bar</a> tau update | Alias for tau <a href="features/cucumber/features/docker/docker.image.update.feature">docker image update</a> tau version | Alias for tau <a href="features/cucumber/features/self/self.version.feature">self version</a></p>

<p><strong>Warning: <em>tau update</em> will call <em>docker image prune</em> and remove all dangling images!</strong></p>

<h2 id="label-Configuration">Configuration</h2>

<h3 id="label-Configuration+Files">Configuration Files</h3>

<p><em>takelage-cli</em> uses three different YAML configuration files which have different precedences. They are merged to an active configuration during runtime which can be inspected with <em>tau <a href="features/cucumber/features/self/self.config.active.feature">self config active</a></em> or <em>tau config</em>.</p>

<p>| Filename | Precedence | Description | | ——– | ———- | ———– | | <em>default.yml</em> | lowest | Shipped with <em>takelage-cli</em>. Sets defaults where applicable. | | <em>~/.takelage.yml</em> | normal | User-wide configuration file in your home directory. This is your normal custom configuration file. | | <em>takelage.yml</em> | highest | Project-specific configuration file next to your main Rakefile. Some projects need special configuration. |</p>

<p>Please remember that a project directory is identified by the main <a href="Rakefile">Rakefile</a>.</p>

<h3 id="label-Configuration+Examples">Configuration Examples</h3>
<ul><li>
<p>You should add the following configuration items in your <em>~/.takelage.yml</em> if you want to use a private bit remote server:</p>
</li></ul>

<pre class="code ruby"><code class="ruby">---
bit_remote: &#39;ssh://bit@bit.example.com:222:/bit&#39;
bit_ssh: &#39;ssh -p 222 bit@bit.example.com&#39;
</code></pre>
<ul><li>
<p>If you want to pin a specific docker tag for one of your projects then create an <em>takelage.yml</em> file with:</p>
</li></ul>

<pre class="code ruby"><code class="ruby">---
docker_tag: &#39;1.2.3&#39;
</code></pre>
<ul><li>
<p>The cucumber tests make use of an <em>~/.takelage.yml</em> to overwrite defaults like:</p>
</li></ul>

<pre class="code ruby"><code class="ruby">---
docker_repo: takelage-mock
</code></pre>

<p>Furthermore, every external command can be reconfigured.</p>

<h3 id="label-Project+Files">Project Files</h3>

<p><em>tau</em> reads two different YAML project files which have different precedences. They are merged to an active configuration during runtime which can be inspected with <em>tau <a href="features/cucumber/features/info/info.project.active.feature">info project active</a></em> or <em>tau project</em>.</p>

<p>| Default filename | Config key | Precedence | Description | | ——– | ———- | ———- | ———– | | <em>project.yml</em> | info_project_main | normal | Main project file. | | <em>private/project.yml</em> | info_project_private | highest | Private project file. Should be in <em>.gitignore</em>. |</p>

<h3 id="label-Bash+Completion">Bash Completion</h3>

<p>Add this to your <a href="https://www.gnu.org/software/bash/manual/html_node/Bash-Startup-Files.html">bash startup files</a>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>&lt;</span><span class='lparen'>(</span><span class='id identifier rubyid_tau'>tau</span> <span class='id identifier rubyid_completion'>completion</span> <span class='id identifier rubyid_bash'>bash</span><span class='rparen'>)</span>
</code></pre>

<h3 id="label-Software+Tests">Software Tests</h3>

<p><em>takelage-cli</em> uses <a href="https://github.com/seattlerb/minitest">minitest</a> unit tests.</p>

<p><em>takelage-cli</em> ships with <a href="https://github.com/cucumber/cucumber">cucumber</a> ruby system tests. It uses cucumber&#39;s <a href="https://github.com/cucumber/aruba">aruba</a> extension and especially its <a href="https://relishapp.com/cucumber/aruba/v/0-11-0/docs/filesystem">filesystem</a> library.</p>

<p><em>takelage-cli</em> <a href="https://docs.docker.com/registry/deploying/">deploys</a> a private docker <a href="https://hub.docker.com/_/registry">registry</a> to conduct end-to-end tests of <em>tau docker</em> commands. The registry exposes port 5005. You need to whitelist it in your host&#39;s docker engine configuration:</p>

<pre class="code ruby"><code class="ruby"><span class='lbrace'>{</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>insecure-registries</span><span class='label_end'>&quot;:</span> <span class='lbracket'>[</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>host.docker.internal:5005</span><span class='tstring_end'>&quot;</span></span>
  <span class='rbracket'>]</span>
<span class='rbrace'>}</span>
</code></pre>

<p><em>takelage-cli</em> deploys a <em><a href="https://hub.docker.com/r/takelage/bitboard">bitboard</a></em> server created with <em><a href="https://github.com/geospin-takelage/takelage-bit">takelage-bit</a></em> to end-to-end test the <em>tau bit</em> commands.</p>
</div></div>

      
    </div>
  </body>
</html>